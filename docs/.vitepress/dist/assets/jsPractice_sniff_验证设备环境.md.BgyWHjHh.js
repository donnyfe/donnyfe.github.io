import{_ as a,c as n,o as l,ag as o}from"./chunks/framework.DPDPlp3K.js";const D=JSON.parse('{"title":"验证设备环境","description":"","frontmatter":{},"headers":[],"relativePath":"jsPractice/sniff/验证设备环境.md","filePath":"jsPractice/sniff/验证设备环境.md"}'),p={name:"jsPractice/sniff/验证设备环境.md"};function e(t,s,c,r,y,i){return l(),n("div",null,s[0]||(s[0]=[o(`<h1 id="验证设备环境" tabindex="-1">验证设备环境 <a class="header-anchor" href="#验证设备环境" aria-label="Permalink to &quot;验证设备环境&quot;">​</a></h1><h2 id="验证浏览器环境" tabindex="-1">验证浏览器环境 <a class="header-anchor" href="#验证浏览器环境" aria-label="Permalink to &quot;验证浏览器环境&quot;">​</a></h2><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki github-light vp-code" tabindex="0"><code><span class="line"><span style="color:#D73A49;">export</span><span style="color:#D73A49;"> const</span><span style="color:#6F42C1;"> isIE</span><span style="color:#D73A49;"> =</span><span style="color:#D73A49;"> function</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#D73A49;">  return</span><span style="color:#D73A49;"> !</span><span style="color:#6F42C1;">isNaN</span><span style="color:#24292E;">(</span><span style="color:#6F42C1;">Number</span><span style="color:#24292E;">(document.documentMode));</span></span>
<span class="line"><span style="color:#24292E;">};</span></span></code></pre></div><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki github-light vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;">// Browser environment sniffing</span></span>
<span class="line"><span style="color:#D73A49;">export</span><span style="color:#D73A49;"> const</span><span style="color:#005CC5;"> inBrowser</span><span style="color:#D73A49;"> =</span><span style="color:#D73A49;"> typeof</span><span style="color:#24292E;"> window </span><span style="color:#D73A49;">!==</span><span style="color:#032F62;"> &#39;undefined&#39;</span></span>
<span class="line"><span style="color:#D73A49;">export</span><span style="color:#D73A49;"> const</span><span style="color:#005CC5;"> inWeex</span><span style="color:#D73A49;"> =</span><span style="color:#D73A49;"> typeof</span><span style="color:#24292E;"> WXEnvironment </span><span style="color:#D73A49;">!==</span><span style="color:#032F62;"> &#39;undefined&#39;</span><span style="color:#D73A49;"> &amp;&amp;</span><span style="color:#D73A49;"> !!</span><span style="color:#24292E;">WXEnvironment.platform</span></span>
<span class="line"><span style="color:#D73A49;">export</span><span style="color:#D73A49;"> const</span><span style="color:#005CC5;"> weexPlatform</span><span style="color:#D73A49;"> =</span><span style="color:#24292E;"> inWeex </span><span style="color:#D73A49;">&amp;&amp;</span><span style="color:#24292E;"> WXEnvironment.platform.</span><span style="color:#6F42C1;">toLowerCase</span><span style="color:#24292E;">()</span></span>
<span class="line"><span style="color:#D73A49;">export</span><span style="color:#D73A49;"> const</span><span style="color:#005CC5;"> UA</span><span style="color:#D73A49;"> =</span><span style="color:#24292E;"> inBrowser </span><span style="color:#D73A49;">&amp;&amp;</span><span style="color:#24292E;"> window.navigator.userAgent.</span><span style="color:#6F42C1;">toLowerCase</span><span style="color:#24292E;">()</span></span>
<span class="line"><span style="color:#D73A49;">export</span><span style="color:#D73A49;"> const</span><span style="color:#005CC5;"> isIE</span><span style="color:#D73A49;"> =</span><span style="color:#005CC5;"> UA</span><span style="color:#D73A49;"> &amp;&amp;</span><span style="color:#032F62;"> /msie</span><span style="color:#D73A49;">|</span><span style="color:#032F62;">trident/</span><span style="color:#24292E;">.</span><span style="color:#6F42C1;">test</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">UA</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#D73A49;">export</span><span style="color:#D73A49;"> const</span><span style="color:#005CC5;"> isIE9</span><span style="color:#D73A49;"> =</span><span style="color:#005CC5;"> UA</span><span style="color:#D73A49;"> &amp;&amp;</span><span style="color:#005CC5;"> UA</span><span style="color:#24292E;">.</span><span style="color:#6F42C1;">indexOf</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;msie 9.0&#39;</span><span style="color:#24292E;">) </span><span style="color:#D73A49;">&gt;</span><span style="color:#005CC5;"> 0</span></span>
<span class="line"><span style="color:#D73A49;">export</span><span style="color:#D73A49;"> const</span><span style="color:#005CC5;"> isEdge</span><span style="color:#D73A49;"> =</span><span style="color:#005CC5;"> UA</span><span style="color:#D73A49;"> &amp;&amp;</span><span style="color:#005CC5;"> UA</span><span style="color:#24292E;">.</span><span style="color:#6F42C1;">indexOf</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;edge/&#39;</span><span style="color:#24292E;">) </span><span style="color:#D73A49;">&gt;</span><span style="color:#005CC5;"> 0</span></span>
<span class="line"><span style="color:#D73A49;">export</span><span style="color:#D73A49;"> const</span><span style="color:#005CC5;"> isChrome</span><span style="color:#D73A49;"> =</span><span style="color:#005CC5;"> UA</span><span style="color:#D73A49;"> &amp;&amp;</span><span style="color:#032F62;"> /chrome</span><span style="color:#22863A;font-weight:bold;">\\/</span><span style="color:#005CC5;">\\d</span><span style="color:#D73A49;">+</span><span style="color:#032F62;">/</span><span style="color:#24292E;">.</span><span style="color:#6F42C1;">test</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">UA</span><span style="color:#24292E;">) </span><span style="color:#D73A49;">&amp;&amp;</span><span style="color:#D73A49;"> !</span><span style="color:#24292E;">isEdge</span></span>
<span class="line"><span style="color:#D73A49;">export</span><span style="color:#D73A49;"> const</span><span style="color:#005CC5;"> isPhantomJS</span><span style="color:#D73A49;"> =</span><span style="color:#005CC5;"> UA</span><span style="color:#D73A49;"> &amp;&amp;</span><span style="color:#032F62;"> /phantomjs/</span><span style="color:#24292E;">.</span><span style="color:#6F42C1;">test</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">UA</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#D73A49;">export</span><span style="color:#D73A49;"> const</span><span style="color:#005CC5;"> isFF</span><span style="color:#D73A49;"> =</span><span style="color:#005CC5;"> UA</span><span style="color:#D73A49;"> &amp;&amp;</span><span style="color:#005CC5;"> UA</span><span style="color:#24292E;">.</span><span style="color:#6F42C1;">match</span><span style="color:#24292E;">(</span><span style="color:#032F62;">/firefox</span><span style="color:#22863A;font-weight:bold;">\\/</span><span style="color:#032F62;">(</span><span style="color:#005CC5;">\\d</span><span style="color:#D73A49;">+</span><span style="color:#032F62;">)/</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#D73A49;">export</span><span style="color:#D73A49;"> const</span><span style="color:#005CC5;"> isAndroid</span><span style="color:#D73A49;"> =</span><span style="color:#24292E;"> (</span><span style="color:#005CC5;">UA</span><span style="color:#D73A49;"> &amp;&amp;</span><span style="color:#005CC5;"> UA</span><span style="color:#24292E;">.</span><span style="color:#6F42C1;">indexOf</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;android&#39;</span><span style="color:#24292E;">) </span><span style="color:#D73A49;">&gt;</span><span style="color:#005CC5;"> 0</span><span style="color:#24292E;">) </span><span style="color:#D73A49;">||</span><span style="color:#24292E;"> (weexPlatform </span><span style="color:#D73A49;">===</span><span style="color:#032F62;"> &#39;android&#39;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#D73A49;">export</span><span style="color:#D73A49;"> const</span><span style="color:#005CC5;"> isIOS</span><span style="color:#D73A49;"> =</span><span style="color:#24292E;"> (</span><span style="color:#005CC5;">UA</span><span style="color:#D73A49;"> &amp;&amp;</span><span style="color:#032F62;"> /iphone</span><span style="color:#D73A49;">|</span><span style="color:#032F62;">ipad</span><span style="color:#D73A49;">|</span><span style="color:#032F62;">ipod</span><span style="color:#D73A49;">|</span><span style="color:#032F62;">ios/</span><span style="color:#24292E;">.</span><span style="color:#6F42C1;">test</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">UA</span><span style="color:#24292E;">)) </span><span style="color:#D73A49;">||</span><span style="color:#24292E;"> (weexPlatform </span><span style="color:#D73A49;">===</span><span style="color:#032F62;"> &#39;ios&#39;</span><span style="color:#24292E;">)</span></span></code></pre></div><h2 id="验证浏览器接口支持" tabindex="-1">验证浏览器接口支持 <a class="header-anchor" href="#验证浏览器接口支持" aria-label="Permalink to &quot;验证浏览器接口支持&quot;">​</a></h2><h3 id="requestanimationframe" tabindex="-1">requestAnimationFrame <a class="header-anchor" href="#requestanimationframe" aria-label="Permalink to &quot;requestAnimationFrame&quot;">​</a></h3><ul><li>检测window.requestAnimationFrame</li></ul><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki github-light vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;">// window.requestAnimationFrame</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">(</span><span style="color:#D73A49;">function</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#D73A49;">    var</span><span style="color:#24292E;"> lastTime </span><span style="color:#D73A49;">=</span><span style="color:#005CC5;"> 0</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#D73A49;">    var</span><span style="color:#24292E;"> vendors </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> [</span><span style="color:#032F62;">&#39;ms&#39;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&#39;moz&#39;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&#39;webkit&#39;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&#39;o&#39;</span><span style="color:#24292E;">];</span></span>
<span class="line"><span style="color:#D73A49;">    for</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">var</span><span style="color:#24292E;"> x </span><span style="color:#D73A49;">=</span><span style="color:#005CC5;"> 0</span><span style="color:#24292E;">; x </span><span style="color:#D73A49;">&lt;</span><span style="color:#24292E;"> vendors.</span><span style="color:#005CC5;">length</span><span style="color:#D73A49;"> &amp;&amp;</span><span style="color:#D73A49;"> !</span><span style="color:#24292E;">window.requestAnimationFrame; </span><span style="color:#D73A49;">++</span><span style="color:#24292E;">x) {</span></span>
<span class="line"><span style="color:#24292E;">        window.requestAnimationFrame </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> window[vendors[x]</span><span style="color:#D73A49;">+</span><span style="color:#032F62;">&#39;RequestAnimationFrame&#39;</span><span style="color:#24292E;">];</span></span>
<span class="line"><span style="color:#24292E;">        window.cancelAnimationFrame </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> window[vendors[x]</span><span style="color:#D73A49;">+</span><span style="color:#032F62;">&#39;CancelAnimationFrame&#39;</span><span style="color:#24292E;">]</span></span>
<span class="line"><span style="color:#D73A49;">                                   ||</span><span style="color:#24292E;"> window[vendors[x]</span><span style="color:#D73A49;">+</span><span style="color:#032F62;">&#39;CancelRequestAnimationFrame&#39;</span><span style="color:#24292E;">];</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">  if</span><span style="color:#24292E;"> (</span><span style="color:#D73A49;">!</span><span style="color:#24292E;">window.requestAnimationFrame)</span></span>
<span class="line"><span style="color:#24292E;">    window.</span><span style="color:#6F42C1;">requestAnimationFrame</span><span style="color:#D73A49;"> =</span><span style="color:#D73A49;"> function</span><span style="color:#24292E;">(</span><span style="color:#E36209;">callback</span><span style="color:#24292E;">, </span><span style="color:#E36209;">element</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#D73A49;">      var</span><span style="color:#24292E;"> currTime </span><span style="color:#D73A49;">=</span><span style="color:#D73A49;"> new</span><span style="color:#6F42C1;"> Date</span><span style="color:#24292E;">().</span><span style="color:#6F42C1;">getTime</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#D73A49;">      var</span><span style="color:#24292E;"> timeToCall </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> Math.</span><span style="color:#6F42C1;">max</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">0</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">16</span><span style="color:#D73A49;"> -</span><span style="color:#24292E;"> (currTime </span><span style="color:#D73A49;">-</span><span style="color:#24292E;"> lastTime));</span></span>
<span class="line"><span style="color:#D73A49;">      var</span><span style="color:#24292E;"> id </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> window.</span><span style="color:#6F42C1;">setTimeout</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">function</span><span style="color:#24292E;">() { </span><span style="color:#6F42C1;">callback</span><span style="color:#24292E;">(currTime </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> timeToCall); },</span></span>
<span class="line"><span style="color:#24292E;">        timeToCall);</span></span>
<span class="line"><span style="color:#24292E;">      lastTime </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> currTime </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> timeToCall;</span></span>
<span class="line"><span style="color:#D73A49;">      return</span><span style="color:#24292E;"> id;</span></span>
<span class="line"><span style="color:#24292E;">    };</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">  if</span><span style="color:#24292E;"> (</span><span style="color:#D73A49;">!</span><span style="color:#24292E;">window.cancelAnimationFrame)</span></span>
<span class="line"><span style="color:#24292E;">    window.</span><span style="color:#6F42C1;">cancelAnimationFrame</span><span style="color:#D73A49;"> =</span><span style="color:#D73A49;"> function</span><span style="color:#24292E;">(</span><span style="color:#E36209;">id</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#6F42C1;">      clearTimeout</span><span style="color:#24292E;">(id);</span></span>
<span class="line"><span style="color:#24292E;">    };</span></span>
<span class="line"><span style="color:#24292E;">}());</span></span></code></pre></div><h3 id="todataurl" tabindex="-1">toDataURL() <a class="header-anchor" href="#todataurl" aria-label="Permalink to &quot;toDataURL()&quot;">​</a></h3><ul><li>检测canvas.toDataURL()</li></ul><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki github-light vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;">// 检测canvas.toDataURL()</span></span>
<span class="line"><span style="color:#D73A49;">function</span><span style="color:#6F42C1;"> supports_canvas</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#D73A49;">    return</span><span style="color:#D73A49;"> !!</span><span style="color:#24292E;">document.</span><span style="color:#6F42C1;">createElement</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;canvas&#39;</span><span style="color:#24292E;">).getContext;</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">function</span><span style="color:#6F42C1;"> supportsToDataURL</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#D73A49;">    if</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">!</span><span style="color:#6F42C1;">supports_canvas</span><span style="color:#24292E;">()) </span><span style="color:#D73A49;">return</span><span style="color:#005CC5;"> false</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#D73A49;">    const</span><span style="color:#005CC5;"> canvas</span><span style="color:#D73A49;"> =</span><span style="color:#24292E;"> document.</span><span style="color:#6F42C1;">createElement</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;canvas&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#D73A49;">    const</span><span style="color:#005CC5;"> data</span><span style="color:#D73A49;"> =</span><span style="color:#24292E;"> canvas.</span><span style="color:#6F42C1;">toDataURL</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;image/png&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#D73A49;">    return</span><span style="color:#24292E;"> (data.</span><span style="color:#6F42C1;">indexOf</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;data:image/png&quot;</span><span style="color:#24292E;">) </span><span style="color:#D73A49;">==</span><span style="color:#005CC5;"> 0</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">const</span><span style="color:#005CC5;"> results</span><span style="color:#D73A49;"> =</span><span style="color:#6F42C1;"> supportsToDataURL</span><span style="color:#24292E;">()</span></span>
<span class="line"><span style="color:#D73A49;"> ?</span><span style="color:#032F62;"> &quot;You browser is cool and supports Canvas.toDataURL();&quot;</span></span>
<span class="line"><span style="color:#D73A49;"> :</span><span style="color:#032F62;"> &quot;You browser is lame and does NOT support Canvas.toDataURL();&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">console.</span><span style="color:#6F42C1;">warn</span><span style="color:#24292E;">(results);</span></span></code></pre></div>`,11)]))}const E=a(p,[["render",e]]);export{D as __pageData,E as default};
