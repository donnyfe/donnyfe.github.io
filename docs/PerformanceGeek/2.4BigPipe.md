
# 2.4 BigPipe

## 定义

BigPipe 通过将页面加载到称为page let 的小部件中，来加快页面渲染速度，并允许浏览器在 php 服务器呈现页面的同时，一直直请求页面不同区块的结构，类似一个“流”传输管道。

## 技术实现

1. 浏览器从服务器请求页面
2. Server 迅速呈现一个包含`<head>`标记的页面框架，以及一个包含空div元素的主体，这些元素充当 pagelet的容器。由于该页面尚未完成，因此与浏览器的HTTP 连接保持打开状态。
3. 浏览器将开始下载bigpipe.js文件，然后它将开始呈现页面。
4. PHP 服务器进程仍在执行，并且一次构建每个Pagelet。Pagelet完成后，其结果将在`<script> BigPipe.onArrive (...)</ script>`标记内发送到浏览器。
5. 浏览器将收到的html代码注入正确的位置。如果小页面需要任何CSS资源，则也将下载这些 CSS 资源。
6. 接收完所有的页面集之后，浏览器将开始加载月那些页面集所需的所有外部JavaScript文件。
7. 下载javaScript后，浏览器将执行所有内联Ja vaScript。
